pipeline:  
  npmrc:
    image: mhart/alpine-node:8
    commands: 
      - cp /secrets/.npmrc $HOME/.npmrc
      - npm i @sharecare/authorization @sharecare/cache-manager @sharecare/express-rest @sharecare/healthcheck @sharecare/request @sharecare/request-local-context @sharecare/sso-client @sharecare/swagger-rest body-parser bunyan config debug express uuid
    volumes:
      - /secrets:/secrets
  
  lololool:
    image: mongo
    commands: 
      - mongo db://mongo:27017
      
  mount-cache:
    image: cloudsc/sso-oauth-authority:deps-cache-v2
    commands:
      - rsync -aHA --delete /root/.ivy2 .
      - rsync -aHA --delete /root/.sbt .      

  docker:
    image: cloudsc/drone-nexus-docker
    repo: delete-me
    privileged: true
    debug: true
    secrets: [ docker_username, docker_password ]

services:
  mongo:
    image: mongo
